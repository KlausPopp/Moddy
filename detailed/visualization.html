

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Visualisation &mdash; Moddy Discrete Event Simulator 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Model Checking" href="modelchecking.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Moddy Discrete Event Simulator
          

          
            
            <img src="../_static/moddy-logo-200px.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Detailed User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coresim.html">Core Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="fsm.html">Modelling with Finite State Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="seqprog.html">Sequential Program Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelchecking.html">Model Checking</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Visualisation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sequence-diagram-generation">Sequence Diagram Generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elements-of-a-sequence-diagram">Elements of a sequence diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="#details-of-a-sequence-diagram">Details of a Sequence Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-interactive-viewer">Using the Interactive Viewer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#structure-graph-generation">Structure Graph Generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#trace-table-generation">Trace Table Generation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#state-machine-graph-generation">State Machine Graph Generation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrating_to_moddy2.html">Porting from Moddy 1 to 2</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Moddy Discrete Event Simulator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Detailed User Guide</a> &raquo;</li>
        
      <li>Visualisation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/detailed/visualization.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="visualisation">
<span id="detailed-visualization"></span><h1>Visualisation<a class="headerlink" href="#visualisation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sequence-diagram-generation">
<h2>Sequence Diagram Generation<a class="headerlink" href="#sequence-diagram-generation" title="Permalink to this headline">¶</a></h2>
<p>Moddy can generate sequence diagrams to show the communication between Moddy parts, including their timing information.</p>
<p>To generate a sequence diagrams, your code must call <a class="reference internal" href="../reference/results.html#moddy.interactive_sequence_diagram.gen_interactive_sequence_diagram" title="moddy.interactive_sequence_diagram.gen_interactive_sequence_diagram"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_interactive_sequence_diagram()</span></code></a>
after the simulation has finished.
The parameters provided to <a class="reference internal" href="../reference/results.html#moddy.interactive_sequence_diagram.gen_interactive_sequence_diagram" title="moddy.interactive_sequence_diagram.gen_interactive_sequence_diagram"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_interactive_sequence_diagram()</span></code></a> define the appearance of the sequence diagram.</p>
<p>Moddy generates interactive diagrams, that can be opened in a browser and the time scale
can be dynamically adjusted to see less or more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The static diagram generator has been removed in moddy 2.x</p>
</div>
<div class="section" id="elements-of-a-sequence-diagram">
<h3>Elements of a sequence diagram<a class="headerlink" href="#elements-of-a-sequence-diagram" title="Permalink to this headline">¶</a></h3>
<div class="figure align-default">
<img alt="../_images/0400_sd_elements.PNG" src="../_images/0400_sd_elements.PNG" />
</div>
</div>
<div class="section" id="details-of-a-sequence-diagram">
<h3>Details of a Sequence Diagram<a class="headerlink" href="#details-of-a-sequence-diagram" title="Permalink to this headline">¶</a></h3>
<p>The interactive sequence diagrams are generated as HTML pages with javascript code.</p>
<p>Normally, the viewer embeds the viewer’s javascript and css code in the HTML file, however,
you can specify <code class="docutils literal notranslate"><span class="pre">refer_files=True</span></code> to reference the javascript/css files which must be present on your filesystem.
So, if you want to send the HTML file to someone who has no moddy installation, use <code class="docutils literal notranslate"><span class="pre">refer_files=False</span></code>.</p>
<p>Current Browser support:</p>
<blockquote>
<div><ul class="simple">
<li><p>Chrome: OK</p></li>
<li><p>Firefox: OK</p></li>
<li><p>Microsoft Edge: OK</p></li>
<li><p>Safari IOS: OK</p></li>
<li><p>Internet Explorer (up to IE 11): Does not work</p></li>
<li><p>Other browsers not tested</p></li>
</ul>
</div></blockquote>
<p>This is a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">moddy</span><span class="o">.</span><span class="n">gen_interactive_sequence_diagram</span><span class="p">(</span>
                  <span class="n">sim</span><span class="o">=</span><span class="n">simu</span><span class="p">,</span>
                  <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;myExample.html&quot;</span><span class="p">,</span>
                  <span class="n">show_parts_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">],</span>
                  <span class="n">time_per_div</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>A more complex case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">moddy</span><span class="o">.</span><span class="n">gen_interactive_sequence_diagram</span><span class="p">(</span>
                              <span class="n">sim</span><span class="o">=</span><span class="n">simu</span><span class="p">,</span>
                              <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;2_sergw.html&quot;</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Serial Gateway Demo&quot;</span><span class="p">,</span>
                              <span class="n">show_parts_list</span><span class="o">=</span><span class="p">[</span><span class="n">client</span><span class="p">,</span> <span class="n">gateway</span><span class="o">.</span><span class="n">rx_thread</span><span class="p">,</span>
                               <span class="n">gateway</span><span class="o">.</span><span class="n">tx_thread</span><span class="p">,</span> <span class="n">ser_dev</span><span class="p">],</span>
                              <span class="n">excluded_element_List</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;allTimers&#39;</span><span class="p">],</span>
                              <span class="n">time_per_div</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="n">US</span><span class="p">,</span>
                              <span class="n">pix_per_div</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, no timer expiration events are shown, the time division is set to 50|micro|s and each
time division occupies 30 pixels.</p>
</div>
<div class="section" id="using-the-interactive-viewer">
<h3>Using the Interactive Viewer<a class="headerlink" href="#using-the-interactive-viewer" title="Permalink to this headline">¶</a></h3>
<p>Please try the following demo: <a class="reference download internal" download="" href="../_downloads/29c5e37c9192fc74d8b6d39b0876ae80/2_sergw.html"><code class="xref download docutils literal notranslate"><span class="pre">2_sergw</span></code></a></p>
<p>The major interactive functions of the viewer are:</p>
<blockquote>
<div><ul>
<li><p>Time Scaling</p>
<blockquote>
<div><ul>
<li><p>A time scale factor of 0.01 … 100, relative to the initial time resolution is supported.
To change the current time scale</p>
<blockquote>
<div><ul class="simple">
<li><p>Use +/- keys on keyboard</p></li>
<li><p>Use the Time Scale Slider</p></li>
<li><p>Hold the shift key and move mouse up and down</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Adaption of part spacing</p>
<blockquote>
<div><ul class="simple">
<li><p>Drag one of the part boxes (“CarInfoSys” in the example above) and move it horizontally.
The parts on the right automatically follow.</p></li>
<li><p>SHIFT+Drag one of the part boxes (but not the first one) and move it horizontally.
The distances between all parts are changed accordingly.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Time Markers</p>
<blockquote>
<div><ul class="simple">
<li><p>Can be used as a ruler or to measure a time delta.</p></li>
<li><p>Two time markers are supported: A green and a red one.</p></li>
<li><p>A mouse click somewhere in the diagram activates the green time marker.</p></li>
<li><p>A CTRL+mouse click somewhere in the diagram activates the red time marker.</p></li>
<li><p>If both time markers are activated, the delta time between the two time markers is displayed in the title bar.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="structure-graph-generation">
<h2>Structure Graph Generation<a class="headerlink" href="#structure-graph-generation" title="Permalink to this headline">¶</a></h2>
<p>Moddy can also generate files to show the static structure of the model.
Very useful to document the model and to explain the model to others.</p>
<p>An example structure graph:</p>
<div class="figure align-default">
<img alt="../_images/0410_structuregraph.png" src="../_images/0410_structuregraph.png" />
</div>
<ul>
<li><p>The parts hierarchy is shown: For example, EcDev1 contains two sub-parts: “uC” and “FPGA”.</p></li>
<li><p>The ports of a part are shown: For example, EcDev1 has a “ucPort” and an “ecPort”.</p></li>
<li><p>The port bindings are shown:</p>
<blockquote>
<div><ul class="simple">
<li><p>The thin, directed arrows show unidirectional bindings, from an output port to an input port.</p></li>
<li><p>The thick, undirected arrows show bidirectional bindings between IO-Ports.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The message type transferred between ports are shown (e.g. EcMsg):
Moddy learns during the simulation which message types (python classes) are transferred.</p></li>
<li><p>The relation between schedulers and parts are shown. In the example above, “schedCp” controls “App”.
In the example below, if the scheduler “sched” controls multiple threads, the relation is shown,
including the thread priorities. (WARNING: This feature does not work under all circumstances)</p></li>
</ul>
<div class="figure align-default">
<img alt="../_images/0420_structuregraph2.png" src="../_images/0420_structuregraph2.png" />
</div>
<p>Moddy uses the <em>GraphViz</em> command line tool <code class="docutils literal notranslate"><span class="pre">dot</span></code> to generate the structure graphs, so <em>GraphViz</em> has to be installed.</p>
<p>The output format is fixed to SVG.</p>
<p>To generate a structure, just call <a class="reference internal" href="../reference/results.html#moddy.dot_structure.gen_dot_structure_graph" title="moddy.dot_structure.gen_dot_structure_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_dot_structure_graph()</span></code></a> after running the simulation.
(You can also run it before the simulation, but then no message types will be shown)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">moddy</span><span class="o">.</span><span class="n">gen_dot_structure_graph</span><span class="p">(</span><span class="n">simu</span><span class="p">,</span> <span class="s1">&#39;2_sergw_structure.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently no way to influence the appearance of the structure graph.</p>
</div>
<div class="section" id="trace-table-generation">
<h3>Trace Table Generation<a class="headerlink" href="#trace-table-generation" title="Permalink to this headline">¶</a></h3>
<p>Moddy can generate a <code class="docutils literal notranslate"><span class="pre">CSV</span></code> (comma separated value) file containing all simulator events.
This file can be viewed with a table calculation program such as MS Excel.</p>
<p>Example:</p>
<div class="figure align-default">
<img alt="../_images/0430_trace.png" src="../_images/0430_trace.png" />
</div>
<p>To generate a trace table, call <a class="reference internal" href="../reference/results.html#moddy.trace_to_csv.gen_trace_table" title="moddy.trace_to_csv.gen_trace_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_trace_table()</span></code></a> after running the simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">moddyGenerateTraceTable</span><span class="p">(</span><span class="n">simu</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;1_hello.csv&#39;</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <em>time_unit</em> specifies the time unit for all time stamps in table (‘s’, ‘ms’, ‘us’, ‘ns’).</p>
<p>Explanation to the events:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>&gt;MSG</strong>: A message transfer starts.</p></li>
<li><p><strong>&gt;MSG(Q)</strong>: A message transfer starts. The message was delayed because another
message was blocking the output port. The requestTime tells you when the model requested the message send</p></li>
<li><p><strong>&lt;MSG</strong>: Message arrived at input port: Note that “Object” specifies the part that contains the output port</p></li>
<li><p><strong>T-START</strong>: A timer has been started</p></li>
<li><p><strong>T-STOP</strong>: A timer has been stopped</p></li>
<li><p><strong>T-RESTA</strong>: A timer was restarted</p></li>
<li><p><strong>T-EXP</strong>: A timer was expired</p></li>
<li><p><strong>ANN</strong>: Model added an annotation</p></li>
<li><p><strong>ASSFAIL:</strong> Assertion failure</p></li>
<li><p><strong>STA</strong>: Part changed its status (via setStatusIndicator)</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="state-machine-graph-generation">
<h2>State Machine Graph Generation<a class="headerlink" href="#state-machine-graph-generation" title="Permalink to this headline">¶</a></h2>
<p>Moddy can also generate graphs to show the finite state machines of the model.
An example state machine graph (from tutorial <code class="docutils literal notranslate"><span class="pre">3_carinfo.py</span></code>):</p>
<div class="figure align-default">
<img alt="../_images/0440_fsm.png" src="../_images/0440_fsm.png" />
</div>
<p>The “Apps” and “Vol” boxes are sub-states of the “normal_op” state.</p>
<p>To generate a state machine graph, just call <a class="reference internal" href="../reference/results.html#moddy.dot_fsm.gen_fsm_graph" title="moddy.dot_fsm.gen_fsm_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_fsm_graph()</span></code></a> after state machine instantiation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">moddy</span><span class="o">.</span><span class="n">gen_fsm_graph</span><span class="p">(</span> <span class="n">fsm</span><span class="o">=</span><span class="n">cis</span><span class="o">.</span><span class="n">fsm</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;3_carinfo_fsm.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently no way to influence the appearance of the graph.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tutorials/index.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modelchecking.html" class="btn btn-neutral float-left" title="Model Checking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Klaus Popp

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>